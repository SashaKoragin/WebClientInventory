<mat-tab-group [style.display]="isload ? 'none' : 'grid'">
    <mat-tab class="tab" label="Журнал заявок на доступ">
        <div class="mat-elevation-z8">
            <form class="search">
                <mat-form-field class="search_blok">
                    <span matPrefix><i class="material-icons">youtube_searched_for</i></span>
                    <input matInput (keyup)="nameJournalAis3.filterstable($event.target.value)"
                        placeholder="Поиск данных">
                </mat-form-field>
                <button class="actual" mat-button (click)="donloadJournal()">Сформировать журнал на отдел</button>
                <button class="actual" mat-button (click)="donloadFullJournal()">Сформировать журнал полный</button>
            </form>
            <div class="tables" #TABLEJOURNALAIS3>
                <table mat-table [dataSource]="nameJournalAis3.dataSource" matSort>


                    <ng-container matColumnDef="IdJournal">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Id</th>
                        <td mat-cell *matCellDef="let row" [matTooltip]="row.IdJournal">
                            {{row.IdJournal}}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="TaskAis3.NameTask">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Наименование задачи</th>
                        <td mat-cell *matCellDef="let row">
                            <Label [style.display]="row.ModelIsEdit ? 'none':'inline'"
                                [matTooltip]="row.TaskAis3?.NameTask">{{row.TaskAis3?.NameTask}}</Label>
                            <div [ngClass]=row.IdJournal.toString() id="{{row.IdJournal}}"
                                [style.display]="!row.ModelIsEdit ? 'none':'block'">
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="ResourceIt.NameResource">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Ресурс</th>
                        <td mat-cell *matCellDef="let row">
                            <Label [style.display]="row.ModelIsEdit ? 'none':'inline'"
                                [matTooltip]="row.ResourceIt?.NameResource">{{row.ResourceIt?.NameResource}}</Label>
                            <div [ngClass]=row.IdJournal.toString() id="{{row.IdJournal}}"
                                [style.display]="!row.ModelIsEdit ? 'none':'block'">
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="User.Otdel.NameOtdel">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Наименование отдела</th>
                        <td mat-cell *matCellDef="let row" [matTooltip]="row.User?.Otdel?.NameOtdel">
                            <Label
                                [style.display]="row.ModelIsEdit ? 'none':'inline'">{{row.User?.Otdel?.NameOtdel}}</Label>
                            <div [style.display]="!row.ModelIsEdit ? 'none':'block'">
                                <label>{{nameJournalAis3.model?.User?.Otdel?.NameOtdel}}</label>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="User.Name">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Имя пользователя</th>
                        <td mat-cell *matCellDef="let row">
                            <Label [style.display]="row.ModelIsEdit ? 'none':'inline'"
                                [matTooltip]="row.User?.Name">{{row.User?.Name}}</Label>
                            <div [ngClass]=row.IdJournal.toString() id="{{row.IdJournal}}"
                                [style.display]="!row.ModelIsEdit ? 'none':'block'">
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="TaskUser">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Дополнительное наименование группы</th>
                        <td mat-cell *matCellDef="let row">
                            <Label [style.display]="row.ModelIsEdit ? 'none':'inline'"
                                [matTooltip]="row.TaskUser">{{row.TaskUser}}</Label>
                            <div [ngClass]=row.IdJournal.toString() id="{{row.IdJournal}}"
                                [style.display]="!row.ModelIsEdit ? 'none':'block'">
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="NameTarget">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Задача/профиль</th>
                        <td mat-cell *matCellDef="let row">
                            <Label [style.display]="row.ModelIsEdit ? 'none':'inline'"
                                [matTooltip]="row.NameTarget">{{row.NameTarget}}</Label>
                            <div [ngClass]=row.IdJournal.toString() id="{{row.IdJournal}}"
                                [style.display]="!row.ModelIsEdit ? 'none':'block'">
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="DateTask">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Дата передачи на исполнение</th>
                        <td mat-cell *matCellDef="let row">
                            <Label [style.display]="row.ModelIsEdit ? 'none':'inline'"
                                [matTooltip]="row.DateTask">{{row.DateTask}}</Label>
                            <div [ngClass]=row.IdJournal.toString() id="{{row.IdJournal}}"
                                [style.display]="!row.ModelIsEdit ? 'none':'block'">
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="ActionsColumn">
                        <th mat-header-cell *matHeaderCellDef>
                            <ng-template [ngxPermissionsExcept]="['Оператор','Просмотр','Безопасность']">
                                <button mat-icon-button color="primary" [disabled]="nameJournalAis3.isAdd"
                                    focusable="false" (click)="nameJournalAis3.add()">
                                    <i class="material-icons">person_add</i>
                                </button>
                            </ng-template>
                        </th>
                        <td [style.background]="row.Statusing?.Color" mat-cell *matCellDef="let row">
                            <ng-template [ngxPermissionsExcept]="['Просмотр','Безопасность']">
                                <button mat-icon-button *ngIf="!row.ModelIsEdit" [disabled]="nameJournalAis3.isEdit"
                                    color="accent" (click)="nameJournalAis3.edit(row)">
                                    <i class="material-icons">edit</i>
                                </button>
                            </ng-template>
                            <ng-template [ngxPermissionsExcept]="['Просмотр','Оператор','Редактор','Безопасность']">
                                <button mat-icon-button *ngIf="!row.ModelIsEdit" [disabled]="nameJournalAis3.isEdit"
                                    (click)="nameJournalAis3.delete(row)">
                                    <i class="material-icons">delete</i>
                                </button>
                            </ng-template>
                            <div *ngIf="row.ModelIsEdit">
                                <button mat-icon-button type="submit"
                                    [disabled]="nameJournalAis3.modelvalid.getRowValidatorModel[12].invalid"
                                    color="primary" focusable="false" (click)="nameJournalAis3.save()">
                                    <i class="material-icons">check</i>
                                </button>
                                <button mat-icon-button color="primary" focusable="false"
                                    (click)="nameJournalAis3.cancel(row)">
                                    <i class="material-icons">cancel</i>
                                </button>
                            </div>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="nameJournalAis3.displayedColumns; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: nameJournalAis3.displayedColumns;"></tr>
                </table>
            </div>
            <mat-paginator class="paginator" #nameJournalAis
                [pageSizeOptions]="[5, 10, 25, paginatornameJournalAis3.length]" showFirstLastButtons="true">
            </mat-paginator>
        </div>
        <div [style.display]="'none'" #TEMPLATEJOURNALAIS3>

            <mat-form-field id="template" class="validation">
                <mat-select (click)="nameJournalAis3.calbackfiltersAll()"
                    [formControl]="nameJournalAis3.modelvalid?.getRowValidatorModel[12].get('TaskAis3')"
                    [placeholder]="nameJournalAis3.model.TaskAis3?.NameTask"
                    [(ngModel)]="nameJournalAis3.model.TaskAis3" name="task">
                    <mat-select-filter class="filter" [placeholder]="nameJournalAis3.model.TaskAis3?.NameTask"
                        [displayMember]="'NameTask'" [array]="nameJournalAis3.taskAis3"
                        (filteredReturn)="nameJournalAis3.filteredTaskAis3 =$event">
                    </mat-select-filter>
                    <mat-option *ngFor="let task of nameJournalAis3.filteredTaskAis3" [value]="task">
                        {{task.NameTask}}
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field id="template" class="validation">
                <mat-select (click)="nameJournalAis3.calbackfiltersAll()"
                    [formControl]="nameJournalAis3.modelvalid?.getRowValidatorModel[12].get('ResourceIt')"
                    [placeholder]="nameJournalAis3.model.ResourceIt?.NameResource"
                    [(ngModel)]="nameJournalAis3.model.ResourceIt" name="resource">
                    <mat-select-filter class="filter" [placeholder]="nameJournalAis3.model.ResourceIt?.NameResource"
                        [displayMember]="'NameResource'" [array]="nameJournalAis3.resourceIt"
                        (filteredReturn)="nameJournalAis3.filteredResourceIt =$event">
                    </mat-select-filter>
                    <mat-option *ngFor="let resource of nameJournalAis3.filteredResourceIt" [value]="resource">
                        {{resource.NameResource}}
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field id="template" class="validation">
                <mat-select (click)="nameJournalAis3.calbackfiltersAll()"
                    [placeholder]="nameJournalAis3.model.User?.Name" [(ngModel)]="nameJournalAis3.model.User"
                    name="user">
                    <mat-select-filter class="filter" [placeholder]="nameJournalAis3.model.User?.Name"
                        [displayMember]="'Name'" [array]="nameJournalAis3.users"
                        (filteredReturn)="nameJournalAis3.filteredUsers =$event">
                    </mat-select-filter>
                    <mat-option [value]='null'>None</mat-option>
                    <mat-option *ngFor="let user of nameJournalAis3.filteredUsers" [value]="user">
                        {{user.Name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field id="template" class="validation">
                <input matInput placeholder="Задача/профиль" [ngModel]="nameJournalAis3.model?.NameTarget"
                    (ngModelChange)="nameJournalAis3.model.NameTarget = $event" />
            </mat-form-field>

            <mat-form-field id="template" class="validation">
                <input matInput placeholder="Дополнительное наименование группы"
                    [ngModel]="nameJournalAis3.model?.TaskUser"
                    (ngModelChange)="nameJournalAis3.model.TaskUser = $event" />
            </mat-form-field>

            <mat-form-field id="template" class="validation">
                <input matInput [matDatepicker]="pickerDate" placeholder="Дата передачи на исполнение"
                    [formControl]="nameJournalAis3.modelvalid?.getRowValidatorModel[12].get('DateTask')"
                    [(ngModel)]="nameJournalAis3.modelvalid?.getRowValidatorModel[12].get('DateTask').value">
                <mat-datepicker-toggle matSuffix [for]="pickerDate"></mat-datepicker-toggle>
                <mat-datepicker #pickerDate></mat-datepicker>
            </mat-form-field>

        </div>
    </mat-tab>
</mat-tab-group>

<div [style.display]="isload ? 'inline':'none'">
    <p>Идет загрузка данных подождите пожалуйста!!!</p>
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    <div class="messages" *ngFor="let mess of loadMessage">
        <p>{{mess}}</p>
    </div>
</div>